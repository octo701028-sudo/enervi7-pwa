<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Enervi 7 • PWA</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0c1022">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600;800&display=swap" rel="stylesheet">
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
  <script defer src="app.js"></script>
</head>
<body>
  <header>
    <div class="brand">⚡ Enervi 7 <small>Align. Awaken. Amplify.</small></div>
    <button class="btn secondary" id="installBtn" style="display:none">安裝 App</button>
  </header>
  <div class="container">
    <div class="card">
      <h1>Enervi 7 能量檢測</h1>
      <div class="kv">
        <div>定位</div><div>數據化 × 體驗化 × 專業化</div>
        <div>使用方式</div><div>移動滑桿 → 按「產生結果」 → 檢視雷達圖與行動建議</div>
        <div>暱稱（選填）</div><div><input id="userName" type="text" placeholder="你的暱稱"></div>
      </div>
    </div>

    <div class="card">
      <h2>評估 0～10（0=完全沒有、10=非常充足）</h2>
      <div class="grid" id="sliders"></div>
      <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn" id="genBtn">✨ 產生結果</button>
        <button class="btn secondary" id="saveBtn" disabled>💾 儲存本次結果</button>
        <button class="btn secondary" id="exportBtn">⬇️ 匯出歷史 CSV</button>
        <button class="btn secondary" id="clearBtn">🗑️ 清除所有歷史</button>
      </div>
    </div>

    <div class="card">
      <h2>雷達圖（七階能量分佈）</h2>
      <canvas id="radar" height="360"></canvas>
    </div>

    <div class="card" id="focusCard" style="display:none">
      <h2>🎯 今日聚焦點</h2>
      <div id="focusText"></div>
    </div>

    <div class="card">
      <h2>七階關鍵字 × 行動建議</h2>
      <div id="details"></div>
    </div>

    <div class="card">
      <h2>📈 歷史紀錄（僅保存在你的裝置）</h2>
      <div id="history"></div>
    </div>

    <footer>© <span id="year"></span> Enervi 7 — Align. Awaken. Amplify.</footer>
  </div>
  <script>
    if ('serviceWorker' in navigator) { navigator.serviceWorker.register('./sw.js'); }
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      const btn = document.getElementById('installBtn');
      btn.style.display = 'inline-block';
      btn.onclick = async () => { deferredPrompt.prompt(); deferredPrompt = null; btn.style.display='none'; };
    });
  </script>
</body>
</html>
